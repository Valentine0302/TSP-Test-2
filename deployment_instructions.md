# Инструкция по развертыванию сайта TSP на Render.com

Этот документ содержит подробные инструкции по развертыванию сайта TSP Transport OÜ с калькулятором морских ставок на платформе Render.com.

## Предварительные требования

- Аккаунт на [Render.com](https://render.com) (бесплатная регистрация)
- Git установлен на вашем компьютере (для загрузки кода в репозиторий)
- GitHub, GitLab или Bitbucket аккаунт (для хранения кода)

## Шаг 1: Подготовка репозитория

1. Создайте новый репозиторий на GitHub/GitLab/Bitbucket
2. Распакуйте архив с проектом на ваш компьютер
3. Инициализируйте Git репозиторий и загрузите код:

```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin <URL_ВАШЕГО_РЕПОЗИТОРИЯ>
git push -u origin main
```

## Шаг 2: Настройка веб-сервиса на Render.com

1. Войдите в свой аккаунт на [Render.com](https://render.com)
2. Нажмите кнопку "New" и выберите "Web Service"
3. Подключите свой репозиторий (GitHub/GitLab/Bitbucket)
4. Заполните следующие поля:
   - **Name**: tsp-website (или любое другое имя)
   - **Environment**: Python
   - **Build Command**: `chmod +x build.sh && ./build.sh`
   - **Start Command**: `gunicorn --chdir api/run sea_freight_api:app`
   - **Plan**: Free

5. В разделе "Advanced" добавьте следующие переменные окружения:
   - `PYTHON_VERSION`: 3.9.0
   - `PORT`: 10000

6. Нажмите "Create Web Service"

## Шаг 3: Проверка развертывания

1. Дождитесь завершения процесса развертывания (обычно занимает 5-10 минут)
2. После успешного развертывания Render предоставит URL вашего сайта (например, https://tsp-website.onrender.com)
3. Откройте этот URL в браузере для проверки работы сайта

## Шаг 4: Настройка статических файлов

Для корректной работы статических файлов (CSS, JavaScript, изображения) необходимо внести небольшие изменения в конфигурацию Flask:

1. Откройте файл `api/run/sea_freight_api.py` в вашем репозитории
2. Добавьте следующий код в начало файла после импорта Flask:

```python
# Настройка статических файлов
app = Flask(__name__, static_folder='static', static_url_path='')

@app.route('/')
def index():
    return app.send_static_file('index.html')
```

3. Сохраните изменения, закоммитьте и отправьте в репозиторий:

```bash
git add api/run/sea_freight_api.py
git commit -m "Configure static files"
git push
```

4. Render автоматически обнаружит изменения и перезапустит ваш сервис

## Устранение неполадок

### Проблема: Статические файлы не загружаются

Убедитесь, что все статические файлы находятся в директории `api/run/static`. Скрипт `build.sh` должен корректно скопировать все файлы в эту директорию.

### Проблема: База данных не сохраняет данные

Render использует эфемерную файловую систему для бесплатных аккаунтов, что означает, что данные SQLite могут быть потеряны при перезапуске сервиса. Для продакшн-окружения рекомендуется использовать внешнюю базу данных.

### Проблема: Ошибка при запуске приложения

Проверьте логи в панели управления Render для выявления конкретной ошибки. Часто проблемы связаны с отсутствующими зависимостями или неправильными путями к файлам.

## Дополнительные настройки

### Настройка собственного домена

1. В панели управления Render выберите ваш веб-сервис
2. Перейдите на вкладку "Settings"
3. Прокрутите вниз до раздела "Custom Domain"
4. Следуйте инструкциям для настройки вашего домена

### Масштабирование

Для увеличения производительности вы можете перейти на платный план Render, который предоставляет больше ресурсов и постоянное хранилище для базы данных.

## Заключение

После выполнения всех шагов у вас будет полностью функциональный сайт TSP Transport OÜ с работающим калькулятором морских ставок, размещенный на Render.com. Сайт будет доступен по URL, предоставленному Render, или по вашему собственному домену, если вы его настроили.
